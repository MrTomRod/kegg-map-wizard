<svg id="kegg-svg-{{ map.map_id }}" title="{{ map.title }}" width="{{ map.width }}" height="{{ map.height }}" version="1.1" baseProfile="full"
     xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <style>.shape { cursor: pointer }</style>
    <g name="shapes">
        {% for shape in map.lines %}{{ shape.svg()|safe }}
        {% endfor %}{# lines in background: they sometimes go through polys#}
        {% for shape in map.polys %}{{ shape.svg()|safe }}
        {% endfor %}
        {% for shape in map.rects %}{{ shape.svg()|safe }}
        {% endfor %}
        {% for shape in map.circles %}{{ shape.svg()|safe }}
        {% endfor %}{# smallest object always in foreground #}
    </g>{% if not map._bbox_mode %}
    <defs>
        <pattern id="kegg-{{ map.kegg_map_wizard.org }}-{{ map.map_id }}-png"
                 width="{{ map.width }}" height="{{ map.height }}" patternUnits="userSpaceOnUse"
                 style="pointer-events: none">
            <image x="0" y="0" width="{{ map.width }}" height="{{ map.height }}" style="pointer-events: none"
                   xlink:href="data:image/png;base64,{{ map.png }}"/>
        </pattern>
    </defs>
    <rect fill="url(#kegg-{{ map.kegg_map_wizard.org }}-{{ map.map_id }}-png)"
          width="{{ map.width }}" height="{{ map.height }}"
          style="pointer-events: none"/>
    <defs id="shape-color-defs">{% for shape in map.shapes() %}{% if shape.definition %}
        {{ shape.definition }}
    {% endif %}{% endfor %}</defs>
{% endif %}
</svg>
